<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Automate programmable - wrs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Automate programmable";
        var mkdocs_page_input_path = "fr\\plc.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> wrs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="" href="../../index.md">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../simulator.md">Simulator</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../library.md">Simulable library</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../synoptic.md">Synoptic</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../modbus.md">Modbus TCP-IP</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../plc.md">Programmable Logic Controller</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../hmi.md">Human Machine Interface</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../speed_controller.md">Speed Controller</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../grapher.md">Grapher</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="../../errors.md">Warning list</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">wrs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Automate programmable</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="automate-programmable">Automate programmable</h1>
<h2 id="preambule">Préambule</h2>
<ul>
<li>Le simulateur permet d'intégrer un automate programmable physique ou virtuel dans un folio.</li>
<li>La communication avec l'API est réalisée en utilisant le protocole <a href="../modbus/">Modbus/Tcp-IP</a> :<ul>
<li>avec l'adresse IP locale (127.0.0.1) du serveur Modbus intégré à l'API virtuel,</li>
<li>avec l'adresse IP statique du serveur Modbus intégré à l'API physique connecté sur un réseau Ethernet.</li>
</ul>
</li>
<li>Cette solution permet d'utiliser les outils de programmation habituels des automates.</li>
<li>Logique d'échange <strong>client (master) (simulateur) &lt;-&gt; serveur (slave) (api)</strong>, périodiquement  :<ul>
<li>le client Modbus  (simulateur)  émet une requête d'écriture des entrées du SAP simulé au serveur Modbus (API),</li>
<li>l'API calcule l'état des sorties du SAP selon son programme et l'état des entrées reçues,</li>
<li>le client Modbus  (simulateur) émet une requête de lecture des sorties calculées par le programme au serveur Modbus (API),</li>
<li>le simulateur met à jour l'état du SAP.</li>
</ul>
</li>
<li>Automates testés :<ul>
<li><strong>M221</strong> Schneider Electric codes fonctions 3,16 et 23, serveur modbus intégré</li>
<li><strong>M340</strong> Schneider Electric code fonctions 3 et 16, serveur modbus intégré</li>
<li><strong>Unilogic</strong> Unitronics codes fonctions 3,16 et 23, configuration du serveur Modbus requise :</li>
</ul>
</li>
</ul>
<p><img alt="" src="fr/media/unilogic.png" /></p>
<p>L'exemple ci-dessous utilise <strong>EcoStruxure Basic Expert de SchneiderElectric</strong> qui permet la programmation et la simulation des automates de la famille M221.</p>
<h2 id="exemple-ascenseur">Exemple ascenseur</h2>
<p>(fichiers 15-demo_ascenseur_M221.xrs et 15-demo_ascenseur_M221.smbp)</p>
<h3 id="preparation-cote-wrsimulateur">Préparation côté WRsimulateur :</h3>
<p><img alt="" src="fr/media/lift_example.png" /></p>
<ul>
<li>La commande de l'ascenseur nécessite 8 entrées et 4 sorties TOR. On peut utiliser un M221 type TM221CE16R qui dispose de 9 entrées TOR et de 7 sorties à relais.</li>
<li>Adressage des entrées TOR : %I0.0, %I0.1, %I0.2, %I0.3, %I0.4, %I0.5, %I0.6, %I0.7, %I0.8</li>
<li>Adressage des sorties : %Q0.0, %Q0.1, %Q0.2, %Q0.3, %Q0.4, %Q0.5, %Q0.6</li>
<li>L'exemple étudié implante 8 objets d'entrée et 4 objets de sortie en les identifiant avec les adresses API standards.</li>
</ul>
<p><strong>Affectation des entrées</strong></p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>adresse</td>
<td>mnémonique</td>
<td>commentaire</td>
</tr>
<tr>
<td>%I0.0</td>
<td>E3</td>
<td>appel étage 3</td>
</tr>
<tr>
<td>%I0.1</td>
<td>E2</td>
<td>appel étage 2</td>
</tr>
<tr>
<td>%I0.2</td>
<td>E1</td>
<td>appel étage 1</td>
</tr>
<tr>
<td>%I0.3</td>
<td>P1</td>
<td>cabine à létage 1</td>
</tr>
<tr>
<td>%I0.4</td>
<td>P2</td>
<td>cabine à létage 2</td>
</tr>
<tr>
<td>%I0.5</td>
<td>P3</td>
<td>cabine à létage 3</td>
</tr>
<tr>
<td>%I0.6</td>
<td>PF</td>
<td>porte cabine fermée</td>
</tr>
<tr>
<td>%I0.7</td>
<td>PO</td>
<td>porte cabine ouverte</td>
</tr>
</tbody>
</table>
<p><strong>Affectation des sorties</strong> </p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>adresse</td>
<td>mnémonique</td>
<td>commentaire</td>
</tr>
<tr>
<td>%Q0.0</td>
<td>OUVRIR</td>
<td>Ouvrir porte</td>
</tr>
<tr>
<td>%Q0.1</td>
<td>FERMER</td>
<td>Fermer porte</td>
</tr>
<tr>
<td>%Q0.2</td>
<td>DESCENDRE</td>
<td>Descendre cage</td>
</tr>
<tr>
<td>%Q0.3</td>
<td>MONTER</td>
<td>Monter cage</td>
</tr>
</tbody>
</table>
<h3 id="preparation-cote-ecostruxure-machine-expert-basic">Préparation côté EcoStruxure Machine Expert--Basic</h3>
<p>Le programme complet <strong>15-demo_ascenseur_M221.smbp</strong> est disponible dans le dossier : <img alt="" src="fr/media/image89.png" /></p>
<p>Mise en correspondance des tableaux d'entrées/sorties avec la table d'échange ajustée sur l'adresse de départ %MW400 <a href="../modbus/">voir le mappage modbus</a>:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>adresse</td>
<td>mappage MODBUS</td>
<td>mnémonique</td>
<td>commentaire</td>
</tr>
<tr>
<td>%I0.0</td>
<td>%MW500 :X0</td>
<td>E3</td>
<td>appel étage 3</td>
</tr>
<tr>
<td>%I0.1</td>
<td>%MW500 :X1</td>
<td>E2</td>
<td>appel étage 2</td>
</tr>
<tr>
<td>%I0.2</td>
<td>%MW500 :X2</td>
<td>E1</td>
<td>appel étage 1</td>
</tr>
<tr>
<td>%I0.3</td>
<td>%MW500 :X3</td>
<td>P1</td>
<td>cabine à létage 1</td>
</tr>
<tr>
<td>%I0.4</td>
<td>%MW500 :X4</td>
<td>P2</td>
<td>cabine à létage 2</td>
</tr>
<tr>
<td>%I0.5</td>
<td>%MW500 :X5</td>
<td>P3</td>
<td>cabine à létage 3</td>
</tr>
<tr>
<td>%I0.6</td>
<td>%MW500 :X6</td>
<td>PF</td>
<td>porte cabine fermée</td>
</tr>
<tr>
<td>%I0.7</td>
<td>%MW500 :X7</td>
<td>PO</td>
<td>porte cabine ouverte</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>adresse</td>
<td>mappage MODBUS</td>
<td>mnémonique</td>
<td>commentaire</td>
</tr>
<tr>
<td>%Q0.0</td>
<td>%MW400 :X0</td>
<td>OUVRIR</td>
<td>Ouvrir porte</td>
</tr>
<tr>
<td>%Q0.1</td>
<td>%MW400 :X1</td>
<td>FERMER</td>
<td>Fermer porte</td>
</tr>
<tr>
<td>%Q0.2</td>
<td>%MW400 :X2</td>
<td>DESCENDRE</td>
<td>Descendre cage</td>
</tr>
<tr>
<td>%Q0.3</td>
<td>%MW401 :X3</td>
<td>MONTER</td>
<td>Monter cage</td>
</tr>
</tbody>
</table>
<p>Dans l'onglet <strong>Programmation -&gt;Outils -&gt; Liste de symboles</strong>, on trouve l'assignation des entrées/sorties qui correspond aux tableaux précédents:
<img alt="" src="fr/media/lift_symbol_list.png" /></p>
<p><strong>Programme API</strong>:
<img alt="" src="fr/media/lift_sfc.png" />
<img alt="" src="fr/media/image95.png" />
<img alt="" src="fr/media/image96.png" /></p>
<p>Démarrer le contrôleur <strong>AVANT</strong> de lancer le simulateur en activant les boutons <strong>Lancer le simulateur</strong> et <strong>Démarrer le contrôleur</strong> dans l'onglet Mise en service d'EcoStruxure:</p>
<p><img alt="" src="fr/media/image98.png" /></p>
<h2 id="construction-dun-objet-api">Construction d'un objet API</h2>
<ul>
<li>
<p>Un automate est construit avec les objets élémentaires :</p>
<ul>
<li>input# pour les entrées TOR,</li>
<li>output# pour les sorties TOR,</li>
<li>analog_input# pour les entrées analogiques,</li>
<li>analog_output# pour les sorties analogiques,</li>
<li>plc_supply# pour l'alimentation de l'API</li>
</ul>
</li>
<li>
<p>Toutes les E/S ont pour parent l'objet plc_supply afin d'asservir l'alimentation de ces E/S à l'alimentation de l'automate.</p>
</li>
<li>Le serveur MODBUS est implicitement attaché à l'automate en place dans le schéma.</li>
<li>On ne peut placer qu'un seul automate dans le schéma.</li>
<li>Des exemples d'automates sont disponibles dans le dossier <a href="../library/">blocs_simulables</a> à partir de la commande 'Ouvrir un bloc' de WinRelais.</li>
</ul>
<p><img alt="" src="fr/media/image104.png" />
Toutes ces empreintes d'automate sont ajustables et modifiables selon les besoins.</p>
<h2 id="entreessorties-logiques">Entrées/Sorties logiques</h2>
<table>
<thead>
<tr>
<th>input, output</th>
<th>bibliothèque _api</th>
</tr>
</thead>
<tbody>
<tr>
<td>%Ir.v ou %Qr.v</td>
<td>r = [0,5] v = [0,31]</td>
</tr>
<tr>
<td>parent =</td>
<td>nom de l'objet <strong>plc_supply#</strong></td>
</tr>
</tbody>
</table>
<p><img alt="" src="fr/media/io_tor.png" /></p>
<h2 id="entrees-analogiques">Entrées analogiques</h2>
<table>
<thead>
<tr>
<th>analog_input</th>
<th>bibliothèque _api</th>
</tr>
</thead>
<tbody>
<tr>
<td>%IWr.v</td>
<td>r = [0,5] v = [0,3]</td>
</tr>
<tr>
<td>parent =</td>
<td>nom de l'objet <strong>plc_supply#</strong></td>
</tr>
<tr>
<td>input_type =</td>
<td>U  ou  I</td>
</tr>
<tr>
<td>input_range =</td>
<td>(min,max) V [-10,10] V ou (min,max) mA [0, 20] mA</td>
</tr>
<tr>
<td>input_scale =</td>
<td>min,max   [-32768, 32767]</td>
</tr>
</tbody>
</table>
<p><img alt="" src="fr/media/analog_inputs.png" /></p>
<h2 id="sorties-analogiques">Sorties analogiques</h2>
<table>
<thead>
<tr>
<th>analog_output</th>
<th>bibliothèque _api</th>
</tr>
</thead>
<tbody>
<tr>
<td>%QW0.0</td>
<td>r = [0,5] v = [0,3]</td>
</tr>
<tr>
<td>parent =</td>
<td>nom de l'objet <strong>plc_supply#</strong></td>
</tr>
<tr>
<td>output_type =</td>
<td>U  ou  I</td>
</tr>
<tr>
<td>output_range =</td>
<td>(min,max) V [-10,10] V ou (min,max) mA [0, 20] mA</td>
</tr>
<tr>
<td>output_scale =</td>
<td>min,max [-32768, 32767]</td>
</tr>
</tbody>
</table>
<p><img alt="" src="fr/media/analog_outputs.png" /></p>
              
            </div>
          </div><footer>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
